<!DOCTYPE html>
<html>

<head>
    <title>資工系壘紀錄表</title>
    <link rel="stylesheet" href="decoration.css">
</head>

<body>
    <h1>比賽紀錄</h1>
    <div class="container">
        <h3>打擊狀況</h3>
        <form>
            <label for="battingDirection">棒次：</label>
            <select id="battingOrder" name="battingOrder">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                <option>11</option>
            </select>

            <label for="playerNumber">背號：</label>
            <input type="number" id="playerNumber" name="playerNumber">

            <label for="battingDirection">打擊方向：</label>
            <select id="battingDirection" name="battingDirection">
                <option>1 (投手)</option>
                <option>2 (捕手)</option>
                <option>3 (一壘)</option>
                <option>4 (二壘)</option>
                <option>5 (三壘)</option>
                <option>6 (游擊)</option>
                <option>7 (左外野)</option>
                <option>8 (中外野)</option>
                <option>9 (右外野)</option>
                <option>10 (free)</option>
            </select>

            <label for="battingResult">打擊結果：</label>
            <select id="battingResult" name="battingResult">
                <option>GO (滾地出局)</option>
                <option>FO (飛球出局)</option>
                <option>FC (野手選擇)</option>
                <option>E (對手失誤)</option>
                <option>K (被三振)</option>
                <option>BB (保送)</option>
                <option>SF (高飛犧牲打)</option>
                <option>1B (一壘安打)</option>
                <option>2B (二壘安打)</option>
                <option>3B (三壘安打)</option>
                <option>HR (全壘打)</option>
            </select>

            <label for="RBI">打點：</label>
            <select id="RBI" name="RBI">
                <option>0 RBI</option>
                <option>1 RBI</option>
                <option>2 RBI</option>
                <option>3 RBI</option>
                <option>4 RBI</option>
            </select>

        </form>

        <button type="button" onclick="displaySelection()">送出資料</button>

        <button type="button" onclick="downloadCSV()">輸出檔案</button>

        <div class="table-resposive">
            <table id="outputTable">
                <tr>
                    <td>棒次</td>
                    <td>選手</td>
                    <td>打擊方向</td>
                    <td>打擊結果</td>
                    <td>打點</td>
                </tr>

            </table>
        </div>
    </div>

    <div class="container">
        <h3>守備狀況</h3>
        <form>
            <label for="OtherbattingOrder">對手棒次：</label>
            <select id="OtherbattingOrder" name="OtherbattingOrder">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                <option>11</option>
            </select>

            <label for="OtherplayerNumber">背號：</label>
            <input type="text" id="OtherplayerNumber" name="OtherplayerNumber">

            <label for="defenderPosition">守備員：</label>
            <select id="defenderPosition" name="defenderPosition">
                <option>1 (投手)</option>
                <option>2 (捕手)</option>
                <option>3 (一壘)</option>
                <option>4 (二壘)</option>
                <option>5 (三壘)</option>
                <option>6 (游擊)</option>
                <option>7 (左外野)</option>
                <option>8 (中外野)</option>
                <option>9 (右外野)</option>
                <option>10 (free)</option>
            </select>

            <label for="defendingResult">投球結果：</label>
            <select id="defendingResult" name="defendingResult">
                <option>GO (滾地出局)</option>
                <option>FO (飛球出局)</option>
                <option>FC (野手選擇)</option>
                <option>E (對手失誤)</option>
                <option>K (被三振)</option>
                <option>BB (保送)</option>
                <option>SF (高飛犧牲打)</option>
                <option>1B (一壘安打)</option>
                <option>2B (二壘安打)</option>
                <option>3B (三壘安打)</option>
                <option>HR (全壘打)</option>
            </select>

            <label for="OtherRBI">對方打點：</label>
            <select id="OtherRBI" name="OtherRBI">
                <option>0 RBI</option>
                <option>1 RBI</option>
                <option>2 RBI</option>
                <option>3 RBI</option>
                <option>4 RBI</option>
            </select>

        </form>

        <button type="button" onclick="displaySelection1()">送出資料</button>

        <button type="button" onclick="downloadCSV1()">輸出檔案</button>

        <div class="table-resposive">
            <table id="outputTable1">
                <tr>
                    <td>對手棒次</td>
                    <td>對方選手</td>
                    <td>守備員</td>
                    <td>投球結果</td>
                    <td>對方打點</td>
                </tr>

            </table>
        </div>
    </div>

    <script>
        function displaySelection() {
            var battingOrder = document.getElementById("battingOrder").value;
            var battingDirection = document.getElementById("battingDirection").value;
            var battingResult = document.getElementById("battingResult").value;
            var RBI = document.getElementById("RBI").value;
            var playerNumber = document.getElementById("playerNumber").value;

            var table = document.getElementById("outputTable");
            var row = table.insertRow(-1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);

            cell1.innerHTML = battingOrder;
            cell2.innerHTML = playerNumber;
            cell3.innerHTML = battingDirection;
            cell4.innerHTML = battingResult;
            cell5.innerHTML = RBI;
        }

        function displaySelection1() {
            var battingOrder = document.getElementById("OtherbattingOrder").value;
            var battingDirection = document.getElementById("defenderPosistion").value;
            var battingResult = document.getElementById("defendingResult").value;
            var RBI = document.getElementById("OtherRBI").value;
            var playerNumber = document.getElementById("OtherplayerNumber").value;

            var table = document.getElementById("outputTable1");
            var row = table.insertRow(-1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);

            cell1.innerHTML = battingOrder;
            cell2.innerHTML = playerNumber;
            cell3.innerHTML = battingDirection;
            cell4.innerHTML = battingResult;
            cell5.innerHTML = RBI;
        }

        function downloadCSV() {
            var table = document.getElementById("outputTable");
            var rows = table.getElementsByTagName("tr");
            var csv = "";
            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName("td");
                for (var j = 0; j < cells.length; j++) {
                    csv += cells[j].innerText + ",";
                }
                csv = csv.slice(0, -1);
                csv += "\n";
            }

            var blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
            var link = document.createElement("a");
            var url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "table.csv");
            link.style.visibility = "hidden";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function downloadCSV1() {
            var table = document.getElementById("outputTable1");
            var rows = table.getElementsByTagName("tr");
            var csv = "";
            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName("td");
                for (var j = 0; j < cells.length; j++) {
                    csv += cells[j].innerText + ",";
                }
                csv = csv.slice(0, -1);
                csv += "\n";
            }

            var blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
            var link = document.createElement("a");
            var url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "table.csv");
            link.style.visibility = "hidden";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function getplayerNumber() {
            var playerNumber = document.getElementById("playerNumber").value;
            alert("Player name is: " + playerNumber);
        }
    </script>

</body>

</html>